# 如何拷贝一个对象

# 深拷贝
规则:
如果拷贝对象时不可变对象,拷贝不会生成新对象,还是原来的.  
如果拷贝对象时个可变对象,以原数据为模板，创造出对象（内层和外层内存地址不再相同）  
所以对之前的对象进行操作,不会影响新的对象.

### 深拷贝方式

copy模块的deep.deepcopy()函数.  
```
import copy
a = [211, 33, 4, [65, 67]]
b = copy.deepcopy(a)
print(id(a), id(b), id(a) == id(b))
print(id(a[-1]) == id(b[-1]))
a[-1].append(66)
print(a,b)
打印结果
2219375197192 2219375297288 False
False
[211, 33, 4, [65, 67, 66]] [211, 33, 4, [65, 67]]
```
### 应用场景

比如在CMDB系统中，我们定义了一个报警模版call给所有的服务器使用，此时有一批特殊应用的服务器需要不通的报警参数，我们既不想单独新建模版来一个一个添加报警参数，又不想修改默认模版而影响其他机器的报警阈值。此时我们就需要用深拷贝来完成。步骤如下:  
1.拷贝默认模板;  
2.修改刚拷贝出的新模板;  
3.酌情使用拷贝出的模板.    
`配置管理数据库( Configuration Management Database,CMDB)`  

# 浅拷贝

### 规则：
 
如果拷贝对象时不可变对象,拷贝不会生成新对象,还是原来的.  
如果拷贝对象时个可变对象,会创建出新的对象，但是只会对最外层进行拷贝,内层还是原来的  
所以对之前的对象进行操作,影响新的对象,(内层嵌套的对象的内存地址未发生改变).  

### 拷贝方式

copy模块中的copy()

```
import copy
a = [211, 33, 4, [65, 67]]
b = copy.copy(a)
print(id(a), id(b), id(a) == id(b))
print(id(a[-1]) == id(b[-1]))
a[-1].append(66)
print(a,b)
打印结果
2386762136520 2386762232712 False
True
[211, 33, 4, [65, 67, 66]] [211, 33, 4, [65, 67, 66]]
```

对于可变对象来(列表，字典，可变集合)来说，可以分别使用内置函数list(),dict(),set(),速度是比使用copy模块快.
```
a = [211, 33, 4, [65, 67]]
b =list(a)
print(id(a), id(b), id(a) == id(b))
print(id(a[-1]) == id(b[-1]))
a[-1].append(66)
print(a,b)
# 打印结果
# 2663019051976 2663019148168 False
# True
# [211, 33, 4, [65, 67, 66]] [211, 33, 4, [65, 67, 66]]
```


切片.
```
import copy
a = [211, 33, 4, [65, 67]]
b = a[:]
print(id(a), id(b), id(a) == id(b))
print(id(a[-1]) == id(b[-1]))
a[-1].append(66)
print(a,b)
# 打印结果
# 2760909519816 2760909616008 False
# True
# [211, 33, 4, [65, 67, 66]] [211, 33, 4, [65, 67, 66]]
```

list的copy()方法.
```
import copy

a = [211, 33, 4, [65, 67]]
b = a.copy()
print(id(a), id(b), id(a) == id(b))
print(id(a[-1]) == id(b[-1])) 
a[-1].append(66)
print(a,b)
# 打印结果
# 2663019051976 2663019148168 False
# True
# [211, 33, 4, [65, 67, 66]] [211, 33, 4, [65, 67, 66]]
```

### 区别

内存消耗:深拷贝比浅拷贝多消耗内存.  
安全性:深拷贝更安全.

赋值
"=”的实际作用是传递对象的引用,"="两端的变量都指向一个对象,通过任意变量对对象进行修改都会相互影响.

```
a = [211, 33, 4]
b = a
print(id(a), id(b), id(a) == id(b))
a.append(66)
print(b)
# 打印结果
# 1440363209288 1440363209288 True

# [211, 33, 4, 66]
```

